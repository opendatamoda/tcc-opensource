<template>
  <header>
    <a href="#ak-container" title="è·³è‡³ä¸»è¦å…§å®¹" id="ak-jump">è·³è‡³ä¸»è¦å…§å®¹</a>
    <h1 class="visually-hidden">è‡ºä¸­å¸‚æ”¿åºœè³‡æ–™é–‹æ”¾å¹³è‡º</h1>
    <div class="header-container">
      <div class="logo">
        <nuxt-link to="/" title="å›é¦–é ">
          é€™è£¡å¯ä»¥æ”¾logo
        </nuxt-link>
      </div>
      <bpa-button
        theme="primary"
        class="btn-mobile-menu"
        @click="handleToggleMobileMenuBtn()"
        value="é¸å–®"
      >
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <title>é¸å–®</title>
        <rect x="2" y="3" width="12" height="2" rx="0.5" fill="#664300"/>
        <rect x="2" y="7" width="12" height="2" rx="0.5" fill="#664300"/>
        <rect x="2" y="11" width="12" height="2" rx="0.5" fill="#664300"/>
      </svg>
      </bpa-button>
      <div :class="['main-menu', mobileMenuStatus ? 'main-menu--open' : '']">
        <nav aria-label="ä¸»è¦é¸å–®">
          <ul>
            <li>
              <a
                href="#ak-header"
                title="ä¸Šæ–¹åŠŸèƒ½å€å¡Š"
                id="ak-header"
                accesskey="U"
              >
                :::
              </a>
            </li>
            <li @click="handleCloseMobileMenuBtn">
              <nuxt-link to="/sitemap" title="å‰å¾€ ç¶²ç«™å°è¦½">
                ç¶²ç«™å°è¦½
              </nuxt-link>
            </li>
            <li>
              <bpa-dropdown
                :options="menuDatasetsOptions"
                placeholder="è³‡æ–™é›†"
                @click="handleMenuDatasets"
              />
            </li>
            <li>
              <bpa-dropdown
                :options="menuAboutOptions"
                placeholder="é—œæ–¼å¹³è‡º"
              />
            </li>
            <li>
              <bpa-dropdown
                :options="menuApplyOptions"
                placeholder="é–‹æ”¾æ‡‰ç”¨"
              />
            </li>
          </ul>
        </nav>
        <bpa-button
          theme="primary"
          class="btn-close-mobile-menu"
          @click="handleCloseMobileMenuBtn()"
        >
          é—œé–‰é¸å–®
        </bpa-button>
      </div>
    </div>
  </header>
</template>

<script lang="ts">
import { defineComponent, ref } from '@vue/composition-api'
export default defineComponent({
  setup(_, { root }) {
    const mobileMenuStatus = ref<boolean>(false);
    const menuDatasetsOptions = ref([
      {
        type: 'link',
        url: '/dataset',
        label: 'æ‰€æœ‰è³‡æ–™é›†',
      },
      {
        type: 'link',
        url: '/categories',
        label: 'åˆ†é¡å°ˆå€',
      },
      {
        label: 'è³‡æ–™æ¸…å–®ä¸‹è¼‰',
      },
    ]);
    const menuAboutOptions = ref([
      {
        type: 'link',
        url: '/about',
        label: 'é—œæ–¼æœ¬ç«™',
      },
      {
        type: 'link',
        url: '/faq',
        label: 'å¸¸è¦‹å•é¡Œ',
      },
      {
        type: 'link',
        url: '/privacy-policy',
        label: 'éš±ç§æ¬Šæ”¿ç­–',
      },
    ])
    const menuApplyOptions = ref([
      {
        type: 'link',
        url: '/develop-guide',
        label: 'é–‹ç™¼æŒ‡å—',
      },
      {
        type: 'link',
        url: 'https://datacenter.taichung.gov.tw/swagger/api-docs/',
        label: 'OPEN API',
      },
      {
        type: 'link',
        url: '/license-terms',
        label: 'æˆæ¬Šæ¢æ¬¾',
      }
    ])

    const handleToggleMobileMenuBtn = () => {
      mobileMenuStatus.value = !mobileMenuStatus.value;
    }

    const handleCloseMobileMenuBtn = () => {
      mobileMenuStatus.value = false;
    }

    const handleMenuDatasets = async() => {
      root.$msg({
        prefix: 'ğŸ˜€',
        msg: 'å³å°‡ä¸‹è¼‰è³‡æ–™é›†æ¸…å–®',
        duration: 3000,
        theme: 'success',
      })
    }

    return {
      mobileMenuStatus, 
      menuDatasetsOptions, menuAboutOptions, menuApplyOptions, handleMenuDatasets,
      handleToggleMobileMenuBtn, handleCloseMobileMenuBtn
    }
  },
})
</script>
